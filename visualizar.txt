import tkinter as tk
from tkinter import messagebox

class View:
    # ... (código previo omitido)

    def visualize_automaton(self):
        automaton = self.controller.get_automaton()

        # Crear una nueva ventana para mostrar el autómata
        window = tk.Toplevel()
        window.title("Visualizar autómata")

        # Crear un lienzo gráfico para dibujar el autómata
        canvas = tk.Canvas(window, width=500, height=400)
        canvas.pack()

        # Dibujar los estados
        for state in automaton.states:
            x = 50
            y = 50
            if state == automaton.initial_state:
                canvas.create_oval(x - 20, y - 20, x + 20, y + 20, fill="green")  # Estado inicial (verde)
            elif state in automaton.final_states:
                canvas.create_oval(x - 20, y - 20, x + 20, y + 20, fill="red")  # Estados finales (rojo)
            else:
                canvas.create_oval(x - 20, y - 20, x + 20, y + 20)  # Estados normales

            canvas.create_text(x, y, text=state)  # Etiqueta del estado

        # Dibujar las transiciones
        for state, transitions in automaton.transitions.items():
            for symbol, target_state in transitions.items():
                x1, y1 = 50, 50  # Posición del estado actual
                x2, y2 = 50, 50  # Posición del estado destino

                # Buscar las coordenadas de los estados en el lienzo
                for item in canvas.find_all():
                    tags = canvas.gettags(item)
                    if len(tags) > 0 and tags[0] == state:
                        x1, y1, _, _ = canvas.coords(item)
                    if len(tags) > 0 and tags[0] == target_state:
                        x2, y2, _, _ = canvas.coords(item)

                # Dibujar la flecha de la transición
                canvas.create_line(x1, y1, x2, y2, arrow=tk.LAST)

                # Calcular la posición del símbolo en la flecha
                symbol_x = (x1 + x2) / 2
                symbol_y = (y1 + y2) / 2

                # Mostrar el símbolo de transición
                canvas.create_text(symbol_x, symbol_y, text=symbol)

        window.mainloop()
